<!DOCTYPE html>
<html>

<head>

	<script src='dist/fhir-client-v2.js'></script>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

  <style>
    #main{background:lightgray; margin:1em; padding:1em;font-size:2em;}
  </style>
</head>

<body>

  <div id="main"></div>

	<script>

		var myApp = {}

    FHIR.oauth2.ready()
    .then(function(client){
      myApp.smart = client
      doRequests()
    })

    async function doRequests(){
      var obs = await fetch(myApp.smart.state.serverUrl+"/Patient/"+myApp.smart.patient.id{
        headers:{
          "Accept":"application/json+fhir",
          "Authorization":"Bearer "+myApp.smart.state.tokenResponse.access_token
        }
        }).then(function(data){
          return data
      })

      var response = await obs.json()
      console.log(response)
  
	</script>

</body>

</html>
